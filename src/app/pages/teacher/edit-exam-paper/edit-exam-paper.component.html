<header class="header">
  <div class="wraper-logo">
    <div class="logo">Online Exam Portal</div>
    <nav class="breadcrumb">
      <span>‚ñ∫</span>
      <span>T·∫°o k√¨ thi</span>
    </nav>
  </div>
  <div class="return-button">
    <button (click)="goBack()">quay laÃ£i</button>
  </div>
</header>

<div class="container">
  <!-- Left content -->
  <div class="left-container">
    <div class="upload-file-container">
      <button class="upload-button" (click)="uploadFile()">üìÇ T·∫£i laÃ£i file</button>
      <input #fileInput id="fileInput" type="file" accept=".pdf,.doc,.docx" (change)="onFileSelected($event)" hidden />
    </div>
    <!-- Ph√¢ÃÄn code hi√™Ãân thiÃ£ file ƒë∆∞∆°Ã£c l√¢ÃÅy t∆∞ÃÄ backend-->
    <div class="exam-from-backend" *ngIf="showDocUrl">
      <iframe [src]="docUrl"></iframe>
    </div>
    <!-- Ch·ªâ hi·ªÉn th·ªã PDF n·∫øu c√≥ file PDF -->
    <div class="pdf-preview-container" *ngIf="selectedFileUrl">
      <iframe [src]="selectedFileUrl" ></iframe>
    </div>

    <!-- Ch·ªâ hi·ªÉn th·ªã Word n·∫øu kh√¥ng c√≥ PDF v√† kh√¥ng c√≥ docUrl -->
    <div class="word-preview-container" #wordContainer *ngIf="!selectedFileUrl && !docUrl"></div>
  </div>

  <!-- Right content -->
  <div class="right-container">
    <div class="tab-header">
      <button class="tab-button" [class.active]="activeTab === 'dapan'" (click)="setActiveTab('dapan')">ƒê√°p √°n</button>
      <button class="tab-button" [class.active]="activeTab === 'thongtin'" (click)="setActiveTab('thongtin')">Th√¥ng tin b√†i thi</button>
    </div>
    <div class="tab-content">
      <div *ngIf="activeTab === 'dapan'" class="tab-pane">
        <div class="score-summary">
          <div class="score-item-wrappper">
            <div class="score-item">
              <label for="totalQuestions">S·ªë c√¢u</label>
              <input
                id="totalQuestions"
                type="number"
                [(ngModel)]="totalQuestions"
                (change)="onTotalQuestionsChange()"
              />
            </div>
            <div class="score-item">
              <label for="totalScore">T·ªïng ƒëi·ªÉm</label>
              <input
                id="totalScore"
                type="number"
                [(ngModel)]="totalScore"
              />
            </div>
          </div>
          <button class="quick-input" (click)="openQuickInput()">Nh·∫≠p nhanh</button>
        </div>

        <!-- N·ªÅn t·ªëi khi modal m·ªü -->
        <div *ngIf="isQuickInputOpen" class="modal-overlay" (click)="isQuickInputOpen = false"></div>

        <!-- Modal nh·∫≠p nhanh -->
        <div *ngIf="isQuickInputOpen" class="quick-input-modal">
          <div class="modal-content">
            <h3 class="modal-title">Nh·∫≠p nhanh</h3>
            <p class="modal-description">
              Chu·ªói ƒë√°p √°n vi·∫øt li·ªÅn kh√¥ng d·∫•u (vd: ACDABCAD). M·ªói k√Ω t·ª± l√† 1 ƒë√°p √°n!
            </p>

            <textarea [(ngModel)]="quickInputText" class="quick-input-area" placeholder="Nh·∫≠p ƒë√°p √°n t·∫°i ƒë√¢y..."></textarea>
            <p *ngIf="errorMessage" class="error-message">{{ errorMessage }}</p>
            <p class="answer-count">B·∫°n s·∫Ω t·∫°o ra {{ quickInputText.length }} ƒë√°p √°n</p>

            <div class="modal-actions">
              <button class="cancel-btn" (click)="isQuickInputOpen = false">H·ªßy</button>
              <button class="confirm-btn" (click)="processQuickInput()">X√°c nh·∫≠n</button>
            </div>
          </div>
        </div>

        <div class="question-list">
          <div *ngFor="let i of getQuestions(); let index = index" class="question-item">
            <label class="question-title">C√¢u {{ i + 1 }}</label>

            <div class="input-group">
              <span class="input-label">ƒê√°p √°n</span>
              <select [(ngModel)]="answers[i + 1]" class="answer-select">
                <option *ngFor="let option of answerOptions" [value]="option">{{ option }}</option>
              </select>
            </div>

            <div class="input-group">
              <span class="input-label">ƒêi·ªÉm</span>
              <input type="text" [value]="getQuestionScore()" class="score-input" disabled />
            </div>
          </div>
        </div>
      </div>


      <div *ngIf="activeTab === 'thongtin'" class="tab-pane">
          <form [formGroup]="examForm" (ngSubmit)="onSubmit()">
          <div class="input-wrapper">
            <label for="ma-de-thi">M√£ ƒë√™ÃÄ thi</label>
            <input type="text" id="ma-de-thi" formControlName="examPaperId">
            <div *ngIf="examForm.get('examPaperId')?.invalid && examForm.get('examPaperId')?.touched" class="error">
              M√£ k·ª≥ thi ph·∫£i c√≥ √≠t nh·∫•t 5 k√Ω t·ª±.
            </div>
          </div>

          <div>
            <label for="thoiGianLamBai">Th·ªùi gian l√†m b√†i:</label>
            <select id="thoiGianLamBai" formControlName="examPaperDuration">
              <option value="15">15 ph√∫t</option>
              <option value="30">30 ph√∫t</option>
              <option value="60">60 ph√∫t</option>
              <option value="90">90 ph√∫t</option>
              <option value="120">120 ph√∫t</option>
            </select>
          </div>
          <div class="input-wrapper">
            <label for="ngay-tao">NgaÃÄy taÃ£o</label>
            <input type="date" id="ngay-tao" formControlName="examPaperDateCreated">
            <div *ngIf="examForm.get('examPaperDateCreated')?.invalid && examForm.get('examPaperDateCreated')?.touched" class="error">
              M√£ k·ª≥ thi ph·∫£i c√≥ √≠t nh·∫•t 5 k√Ω t·ª±.
            </div>
          </div>
          <div class="input-wrapper">
            <label for="trang-thai">TraÃ£ng thaÃÅi</label>
            <select id="trang-thai" formControlName="examPaperStatus">
              <option value="ƒêang m·ªü">ƒêang m·ªü</option>
              <option value="ƒê√£ ƒë√≥ng">ƒê√£ ƒë√≥ng</option>
            </select>
          </div>

          <button type="submit" [disabled]="examForm.invalid">S∆∞Ãâa ƒë√™ÃÄ thi</button>
        </form>
      </div>
    </div>
  </div>
</div>
